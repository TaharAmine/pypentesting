# pypentesting [![GPLv3 license](https://img.shields.io/badge/license-GPLv3-blue.svg)](https://github.com/chrispetrou/pypentesting/blob/master/LICENSE) [![](https://img.shields.io/badge/Made%20with-python-yellow.svg)](https://www.python.org/)

This repository contains some python tools that may be of some help in pentesting, CTFs or information security assignments in general:

*   [shconverter.py](#shconverter) (_objdump2shellcode converter_)
*   [revshell.py](#revshell) (_reverse shell generator_)
*   [explorer.py](#explorer) (_pops a browser with every url we can visit_)
*   [qrutils.py](#qrutils) (_easily decode/encode QR codes_)
*   [vtamper.py](#vtamper) (_verb tampering/avalaibility checker_)
*   [dnz.py](#dnz) (_dns zone transfers_)

## shconverter

This is a small script that takes as input an objdump output and extracts the shellcode:
```
$ ./shconverter.py -h
usage: shconverter.py [-h] [-f] [-c]

shconverter.py: an objdump to shellcode converter

arguments:
  -h, --help    show this help message and exit
  -f , --file   Specify an objdump output-file
  -c, --copy    Copy shellcode to clipboard
```

Example - asm snippet from [here](https://github.com/chrispetrou/asm-snippets/blob/master/x64_execve.asm):

<img src="images/shconverter.png" width="80%">

## revshell

This is a simple script to automate the process of generating a reverse-shell command like those described in [pentestmonkey](http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet) blog:

```
$ ./revshell.py -h
usage: revshell.py [-h] [-l] [-p] [-v] [-c]

revshell.py: generates a reverse shell

arguments:
  -h, --help       show this help message and exit
  -l , --lhost     Specify local host ip
  -p , --lport     Specify a local port [default 8080]
  -v , --version   Specify the language to generate the reverse shell [default bash]
  -c, --copy       Copy reverse-shell command to clipboard
```
Example:

<img src="images/revshell.png" width="80%">

## explorer

This script uses [`selenium`](https://selenium-python.readthedocs.io/) with [chromedriver](https://sites.google.com/a/chromium.org/chromedriver/) (_can work with other web-drivers also_) to open every url (_with a status code of 200_) from a [`dirsearch`](https://github.com/maurosoria/dirsearch) output (_specified with --plain-text-report_):

```
$ ./explorer.py -h
usage: explorer.py [-h] [-f]

explorer.py: dirsearch results-explorer

arguments:
  -h, --help    show this help message and exit
  -f , --file   Specify an dirsearch output-file
```

## qrutils
Easily decode a QR code using [zxing online service](https://zxing.org/w/decode.jspx) or QR-encode a message using [qrencode](https://fukuchi.org/works/qrencode/) utility:
```
$ ./qrutils.py -h
usage: qrutils.py [-h] [-f] (-i  | -m )

qrutils.py: QR encoder/decoder

arguments:
  -h, --help        show this help message and exit
  -f , --filename   Specify an output-name
  -i , --img        Specify a QR-image to decode
  -m , --msg        Specify a message to QR-encode
```

## vtamper

Simple verb avalaibility/tampering checker. Using the `-i` switch it checks also for common header-vulnerabilities:
```
$ ./vtamper.py -h
usage: vtamper.py [-h] [-u] [-vb] [-p] [-i]

vtamper.py: a simple verb tampering/avalaibility checker

arguments:
  -h, --help     show this help message and exit
  -u , --url     Specify a url to check
  -vb , --verb   Use only a specific verb [default None]
  -p, --proxy    Use a proxy [Default: burp settings]
  -i, --inspect  Inspect header for each response [Default: False]
```

## dnz
This script uses [`dnspython`](http://www.dnspython.org/) to perform DNS zone transfers easily:
```
$ ./dnz.py -h
usage: dnz.py [-h] -m  -z  [-p] [-t] [-r]

dnz.py: performs DNS zone transfers

arguments:
  -h, --help        show this help message and exit
  -m , --master     Specify a master DNS server
  -z , --zone       Specify a zone
  -p , --port       Specify a port to use [default 53]
  -t , --timeout    Set timeout [default 120]
  -r, --relativize  Relativize [Default: True]
```

**Requirements:**

*   [dnspython](http://www.dnspython.org/)
*   [selenium](https://www.seleniumhq.org/)
*   [pyperclip](https://pypi.python.org/pypi/pyperclip)
*   [colorama](https://pypi.python.org/pypi/colorama)
*   [validators](https://pypi.python.org/pypi/validators/)

**Note:** To install the requirements (except for [qrencode](https://fukuchi.org/works/qrencode/) and [chromedriver](https://sites.google.com/a/chromium.org/chromedriver/)):

`pip install -r requirements.txt --upgrade --user`

### Disclaimer
>These tools are only for testing and academic purposes and can only be used where strict consent has been given. Do not use them for illegal purposes! It is the end userâ€™s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by these tools, programs, scripts and software.

## License

This project is licensed under the GPLv3 License - see the [LICENSE](LICENSE) file for details